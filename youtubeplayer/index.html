<!DOCTYPE html>
<html>
<head>
    <title>YouTube Player</title>
    <style>
		a {
			color: #ff00ff;
		}
        body {
            background-color: #550055;
            color: #aaffaa;
        }
        button {
            background-color: black;
            color: #aaffaa;
            cursor: pointer;
            margin-top: 3px;
        }
        button:hover {
            background-color: #330033;
        }
        form {
            display: flex;
            flex-direction: column;
            align-items: flex-start;
            margin-bottom: 10px;
        }
        input {
            margin-bottom: 3px;
        }
        label {
            margin-bottom: 5px;
        }
        ul {
            list-style-type: none;
            padding: 0;
            margin: 0;
        }
        .centered {
            display: flex;
            flex-direction: column;
            align-items: center;
        }
		.queueListBorder {
			border: 2px solid #aaffaa;
			padding: 10px;
			margin-top: 20px;
		}
		#controlButtons {
			display: flex;
			justify-content: center;
			margin-top: 10px;
		}
		#controlButtons form {
			margin: 0 5px;
		}
    </style>
</head>
<body>
<a href=https://github.com/NeonLightning/>NeonLightning's github</a>
    <div class="centered">
        <form action="/close" method="post">
            <button type="submit">Close Player</button>
        </form>
        <h1>YouTube Player</h1>
        <form action="/" method="post">
            <label for="search_term">Search:</label>
            <input type="text" id="search_term" name="search_term">
            <button type="submit">Search</button>
        </form>
        {% if message %}
            <p>{{ message }}</p>
        {% endif %}
        <form action="{{ url_for('add_to_queue') }}" method="post">
            <label for="video_url">URL:</label>
            <input type="text" id="video_url" name="video_url" required>
            <button type="submit">Add to Queue</button>
        </form>
		<div id="controlButtons">
			{% if app.config['VIDEO_QUEUE'] %}
			<form action="/play" method="post">
				<button type="submit">Play</button>
			</form>
			<form action="/shuffle_queue" method="get">
				<button type="submit">Shuffle</button>
			</form>
			<form action="/clear" method="post">
				<button type="submit">Clear</button>
			</form>
			{% endif %}
			<form action="/skip" method="post">
				<button type="submit">Skip</button>
			</form>
		</div>
		<ul id="queueList" class="{% if app.config['VIDEO_QUEUE'] %}queueListBorder{% endif %}">
		</ul>
        {% if results %}
            <h2>Search Results</h2>
            <ul id="searchResults">
			{% for result in results %}
			<li style="display: flex;">
				<form action="/queue" method="post">
					<input type="hidden" name="video_url" value="{{ result.video_url }}">
					<button type="submit">Queue</button>
				</form>
				<a href="https://www.youtube.com/watch?v={{ result.video_url }}" target="_blank">{{ result.title }}</a>
			</li>
			{% endfor %}
            </ul>
        {% endif %}
    </div>
    <script>
		function updateQueue() {
			fetch('/get_queue')
				.then(response => response.json())
				.then(data => {
					const queueList = document.getElementById('queueList');
					queueList.innerHTML = '';
					data.forEach((videoInfo, index) => {
						const li = document.createElement('li');
					    const toTopForm = document.createElement('form');
						toTopForm.setAttribute('action', '/move_to_top');
						toTopForm.setAttribute('method', 'post');
						toTopForm.setAttribute('style', 'display:inline-block;');
						const toTopInput = document.createElement('input');
						toTopInput.setAttribute('type', 'hidden');
						toTopInput.setAttribute('name', 'index');
						toTopInput.setAttribute('value', index);
						const toTopButton = document.createElement('button');
						toTopButton.setAttribute('type', 'submit');
						toTopButton.textContent = '⇑';
						toTopForm.appendChild(toTopInput);
						toTopForm.appendChild(toTopButton);
						li.appendChild(toTopForm);
						const upForm = document.createElement('form');
						upForm.setAttribute('action', '/move_up');
						upForm.setAttribute('method', 'post');
						upForm.setAttribute('style', 'display:inline-block;');
						const upInput = document.createElement('input');
						upInput.setAttribute('type', 'hidden');
						upInput.setAttribute('name', 'index');
						upInput.setAttribute('value', index);
						const upButton = document.createElement('button');
						upButton.setAttribute('type', 'submit');
						upButton.textContent = '▲';
						upForm.appendChild(upInput);
						upForm.appendChild(upButton);
						li.appendChild(upForm);
						const downForm = document.createElement('form');
						downForm.setAttribute('action', '/move_down');
						downForm.setAttribute('method', 'post');
						downForm.setAttribute('style', 'display:inline-block;');
						const downInput = document.createElement('input');
						downInput.setAttribute('type', 'hidden');
						downInput.setAttribute('name', 'index');
						downInput.setAttribute('value', index);
						const downButton = document.createElement('button');
						downButton.setAttribute('type', 'submit');
						downButton.textContent = '▼';
						downForm.appendChild(downInput);
						downForm.appendChild(downButton);
						li.appendChild(downForm);
						const toBottomForm = document.createElement('form');
						toBottomForm.setAttribute('action', '/move_to_bottom');
						toBottomForm.setAttribute('method', 'post');
						toBottomForm.setAttribute('style', 'display:inline-block;');
						const toBottomInput = document.createElement('input');
						toBottomInput.setAttribute('type', 'hidden');
						toBottomInput.setAttribute('name', 'index');
						toBottomInput.setAttribute('value', index);
						const toBottomButton = document.createElement('button');
						toBottomButton.setAttribute('type', 'submit');
						toBottomButton.textContent = '⇓';
						toBottomForm.appendChild(toBottomInput);
						toBottomForm.appendChild(toBottomButton);
						li.appendChild(toBottomForm);
						const removeForm = document.createElement('form');
						removeForm.setAttribute('action', '/remove');
						removeForm.setAttribute('method', 'post');
						removeForm.setAttribute('style', 'display:inline;');
						const removeInput = document.createElement('input');
						removeInput.setAttribute('type', 'hidden');
						removeInput.setAttribute('name', 'index');
						removeInput.setAttribute('value', index);
						const removeButton = document.createElement('button');
						removeButton.setAttribute('type', 'submit');
						removeButton.textContent = 'Remove';
						removeForm.appendChild(removeInput);
						removeForm.appendChild(removeButton);
						li.appendChild(removeForm);
						const link = document.createElement('a');
						link.setAttribute('href', `https://www.youtube.com/watch?v=${videoInfo.video_id}`);
						link.setAttribute('target', '_blank');
						link.textContent = videoInfo.title;
						li.appendChild(link);
						queueList.appendChild(li);
					});
				});
		}
		setInterval(updateQueue, 1000);
		updateQueue();
    </script>
</body>
</html>